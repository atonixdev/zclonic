{% extends 'base.html' %}

{% block content %}

  <section class="pricing-hero">
    <div class="container">
      <h1>Simple, predictable pricing</h1>
      <p class="muted">Start free. Scale when you're ready — transparent pricing for individuals and teams.</p>
    </div>
  </section>

  <section class="pricing-grid">
    <div class="container">
      <div class="grid">
        <div class="plan-card">
          <div class="plan-badge">Free</div>
          <h3>Free</h3>
          <p class="muted">100 queries / month</p>
          <a class="btn" href="#">Get started</a>
        </div>

        <div class="plan-card plan-popular">
          <div class="plan-badge">Popular</div>
          <h3>Pro</h3>
          <p class="muted">$29 / month — unlimited queries</p>
          <button class="btn btn-primary" id="buy-pro">Get Started — It's free</button>
          <div style="margin-top:0.5rem; font-size:0.9rem; color:var(--muted);">Or pay with PayPal / Crypto (coming soon)</div>
        </div>

        <div class="plan-card">
          <div class="plan-badge">Team</div>
          <h3>Team</h3>
          <p class="muted">$99 / month — shared workspace & billing</p>
          <a class="btn" href="#">Contact sales</a>
        </div>
      </div>
    </div>
  </section>

  <script>
    document.addEventListener('DOMContentLoaded', function(){
      const buyBtn = document.getElementById('buy-pro');
      if(buyBtn){
        buyBtn.addEventListener('click', function(){
          buyBtn.disabled = true;
          fetch('/api/stripe/create-checkout-session', {
            method: 'POST',
            headers: {'Content-Type':'application/json'},
            body: JSON.stringify({plan:'pro'})
          }).then(r=>r.json()).then(j=>{
            buyBtn.disabled = false;
            if(j.error){ alert('Error: '+j.error); return; }
            // redirect to stripe
            if(j.url) window.location = j.url;
            else if(j.sessionId && typeof Stripe !== 'undefined'){
              var s = Stripe('{{ config.STRIPE_PUBLISHABLE_KEY }}');
              s.redirectToCheckout({sessionId: j.sessionId});
            } else {
              alert('Checkout not available');
            }
          }).catch(err=>{ buyBtn.disabled = false; alert('Request failed: '+err); });
        });
      }
    });
  </script>

{% endblock %}
